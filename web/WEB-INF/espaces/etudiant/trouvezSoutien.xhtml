<ui:composition template="../templates/espaceEtudiant.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:fun="http://java.sun.com/jsp/jstl/functions"
                xmlns:f="http://java.sun.com/jsf/core">
    <ui:define name="title">Trouvez un Soutien | HelpYAcademy</ui:define>
    <ui:define name="page-title">Liste des professeurs qui enseigne cette matiere</ui:define>
    <ui:define name="page-subtitle"></ui:define>
    <ui:define name="page-content">
        <h:messages styleClass="alert #{trouverSoutienBean.success ? 'alert-success':'alert-danger'} col-sm-12" style="padding-left: 40px;margin-top:10px"/>
        <div class="col-sm-12" style="padding-top: 10px">
            <c:forEach items="#{trouverSoutienBean.listMatiereEns()}" var="m">
                <c:set value="#{trouverSoutienBean.getProfByID(m.enseignerPK.idProf)}" var="prof"/>
                <div class="col-md-4">
                    <div class="box box-widget widget-user-2">
                        <div class="widget-user-header bg-red">
                            <div class="widget-user-image">
                                <h:graphicImage library="img" name="avatar5.png" styleClass="img-circle"/>
                            </div>
                            <h3 class="widget-user-username">${fun:toUpperCase(prof.nom)} ${fun:toUpperCase(prof.prenom)}</h3>
                            <h5 class="widget-user-desc">#{prof.situationPro}</h5>
                        </div>
                        <div class="box-footer no-padding">
                            <ul class="nav nav-stacked">
                                <li><a href="#"><b>Prix/Heure</b> <span class="pull-right" style="color: #00a65a;border: 1px #00a65a solid;padding-left: 10px;padding-right: 10px">#{m.prixHeure} DH</span></a></li>
                                <li><a href="#"><b>Cadeau 20 min</b> <span class="pull-right badge #{m.cadeau20Min ? 'bg-green':'bg-red'}">#{m.cadeau20Min ? 'Oui':'Non'}</span></a></li>
                                <li><a href="#"><b>Description</b><p>#{m.description}</p></a></li>
                            </ul>
                        </div>
                        <div class="box-footer">
                            <h:form styleClass="text-center">
                                <h:commandButton value="Commander" styleClass="btn btn-sm btn-block btn-default" action="#{trouverSoutienBean.initCommande(m.enseignerPK.idMatiere,m.enseignerPK.idProf,m.cadeau20Min,m.prixHeure)}"
                                                 onclick="$('#CommanderModal').modal('show');">
                                    <f:ajax execute="@this" render="cmdForm:heureDebut cmdForm:dateDebut cmdForm:cours cmdForm:prix cmdForm:cadeau20min cmdForm:duree cmdForm:titre"/>
                                </h:commandButton>
                            </h:form>
                        </div>
                    </div>
                    <!-- /.widget-user -->
                </div>
            </c:forEach>
        </div>
        <!-- Commander un soutien Modal -->
        <div class="modal fade" id="CommanderModal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <h:form id="cmdForm" styleClass="form-horizontal">
                        <div class="modal-header bg-green">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"><i class="fa fa-close"></i></span></button>
                            <h4 class="modal-title text-center" id="myModalLabel"> Commande de la Matière <h:outputText id="titre" value="#{trouverSoutienBean.matiere}"/> </h4>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <h:outputLabel for="cadeau20min" styleClass="col-sm-3 control-label" value="Cadeau 20 min"/>
                                <div class="col-sm-9">
                                    <h:selectBooleanCheckbox id="cadeau20min" value="#{trouverSoutienBean.cadeau20min}" disabled="#{trouverSoutienBean.ccadeau20min ? 'false':'true'}" styleClass="checkbox" />
                                </div>
                            </div>
                            <div class="form-group">
                                <h:outputLabel for="cours" styleClass="col-sm-3 control-label" value="Titre du Cours"/>
                                <div class="col-sm-9">
                                    <h:inputText id="cours" value="#{trouverSoutienBean.titre}" styleClass="form-control" required="true" requiredMessage="Veuillez saisir le titre du cours"/>
                                </div>
                            </div>
                            <div class="form-group" style="border-top: 1px #e6e6e6 solid;border-bottom: 1px #e6e6e6 solid;padding-top: 15px;padding-bottom: 15px">
                                <h:outputLabel for="desc" styleClass="col-sm-3 control-label" value="Vos Questions"/>
                                <div class="col-sm-9">
                                    <h:inputTextarea id="desc" value="#{trouverSoutienBean.description}" styleClass="form-control" required="true" requiredMessage="Veuillez indiquer Vos Questions"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <h:outputLabel for="duree" styleClass="col-sm-3 control-label" value="Durée"/>
                                <div class="col-sm-9">
                                    <h:selectOneMenu id="duree" value="#{trouverSoutienBean.duree}" styleClass="form-control" valueChangeListener="#{trouverSoutienBean.actualisePrix}" required="true" requiredMessage="Entrez la Durée du cours">
                                        <f:selectItem itemValue="30" itemLabel="30 min"/>
                                        <f:selectItem itemValue="45" itemLabel="45 min"/>
                                        <f:selectItem itemValue="60" itemLabel="1 h"/>
                                        <f:selectItem itemValue="75" itemLabel="1 h 15 min"/>
                                        <f:selectItem itemValue="90" itemLabel="1 h 30 min"/>
                                        <f:selectItem itemValue="105" itemLabel="1 h 45 min"/>
                                        <f:selectItem itemValue="120" itemLabel="2 h "/>
                                        <f:selectItem itemValue="135" itemLabel="2 h 15 min"/>
                                        <f:selectItem itemValue="150" itemLabel="2 h 30 min"/>
                                        
                                        <f:ajax execute="@this" event="change" render="prix"/>
                                    </h:selectOneMenu>
                                    
                                </div>
                            </div>
                            <div class="form-group">
                                <h:outputLabel for="prix" styleClass="col-sm-3 control-label" value="Prix Total"/>
                                <div class="col-sm-4">
                                    <h:outputLabel id="prix" value="#{trouverSoutienBean.prixTotal} DH" styleClass="control-label"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <h:outputLabel for="dateDebut" styleClass="col-sm-3 control-label" value="Date Début" style="margin-right: 15px"/>
                                <div class="col-sm-3 input-group">
                                    <h:inputText id="dateDebut" value="#{trouverSoutienBean.dateDebut}" styleClass="form-control input-small" required="true" requiredMessage="Veuillez indiquer la date de début"/>
                                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                </div>
                            </div>
                            <div class="form-group">
                                <h:outputLabel for="heureDebut" styleClass="col-sm-3 control-label" value="Heure Début" style="margin-right: 15px"/>
                                <div class="col-sm-3 input-group bootstrap-timepicker timepicker">
                                    <h:inputText id="heureDebut" value="#{trouverSoutienBean.heureDebut}" styleClass="form-control input-small" required="true" requiredMessage="Veuillez indiquer l'heure de début"/>
                                    <span class="input-group-addon"><i class="fa fa-clock-o"></i></span>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Fermer</button>
                            <h:commandButton styleClass="btn btn-success" value="Passer la Commande" action="#{trouverSoutienBean.validerCMD()}"/>
                        </div>
                    </h:form>
                </div>
            </div>
        </div>
    </ui:define>
    <ui:define name="js">
        <h:outputScript library="js" name="bootstrap-switch.min.js"/>
        <h:outputScript library="js" name="bootstrap3-wysihtml5.all.min.js"/>
        <h:outputScript library="js" name="bootstrap-datepicker.js" />
        <h:outputScript library="js" name="bootstrap-timepicker.min.js" />
        <script>
            //
            //$('#cmdForm\\:cadeau20min').attr('data-size', 'mini');
            //$('#cmdForm\\:cadeau20min').bootstrapSwitch();
            
            function clean(){
                $('#cmdForm\\:desc').val("");
            }

            $('#cmdForm\\:dateDebut').datepicker({
                autoclose: true,
                format: "yyyy-mm-dd"
            });

            $("#cmdForm\\:heureDebut").timepicker({
                defaultTime: false,
                minuteStep: 1,
                showMeridian: false
            });

            $("#cmdForm\\:desc").wysihtml5({
                toolbar: {
                    'link': false,
                    'blockquote': false,
                    'image': false,
                    'color': false
                }
            });
        </script>
    </ui:define>
    <ui:define name="css">
        <h:outputStylesheet library="css" name="bootstrap-switch.min.css"/>
        <h:outputStylesheet library="css" name="bootstrap-wysihtml5.css" />
        <h:outputStylesheet library="css" name="datepicker3.css" />
        <h:outputStylesheet library="css" name="bootstrap-timepicker.min.css" />
    </ui:define>
</ui:composition>